BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%blush%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 270998732.616437
 ALGERIA                   |   1997 | 459137456.360407
 ALGERIA                   |   1996 | 466102043.921477
 ALGERIA                   |   1995 | 466011748.459864
 ALGERIA                   |   1994 | 459568339.004151
 ALGERIA                   |   1993 |  460470819.68024
 ALGERIA                   |   1992 | 463744981.127028
 ARGENTINA                 |   1998 | 272664316.027853
 ARGENTINA                 |   1997 |  468917122.44028
 ARGENTINA                 |   1996 | 467697048.016653
 ARGENTINA                 |   1995 | 471397682.502227
 ARGENTINA                 |   1994 | 462803059.231193
 ARGENTINA                 |   1993 | 466845714.339041
 ARGENTINA                 |   1992 |  465145987.20025
 BRAZIL                    |   1998 |  272006226.09058
 BRAZIL                    |   1997 | 460624330.318306
 BRAZIL                    |   1996 | 468892470.528396
 BRAZIL                    |   1995 |  470025874.06807
 BRAZIL                    |   1994 | 468942654.492775
 BRAZIL                    |   1993 | 462765805.145051
 BRAZIL                    |   1992 | 475132396.690732
 CANADA                    |   1998 | 280930854.741688
 CANADA                    |   1997 | 479180290.952097
 CANADA                    |   1996 | 473114627.707626
 CANADA                    |   1995 | 479968062.905692
 CANADA                    |   1994 | 487846133.583424
 CANADA                    |   1993 | 476881555.166184
 CANADA                    |   1992 | 473055766.529697
 CHINA                     |   1998 | 270847264.466525
 CHINA                     |   1997 |  454680023.89225
 CHINA                     |   1996 | 471408120.083913
 CHINA                     |   1995 | 469237350.539852
 CHINA                     |   1994 | 464541576.327529
 CHINA                     |   1993 |  466808753.48012
 CHINA                     |   1992 | 471552184.838693
 EGYPT                     |   1998 | 271180525.884805
 EGYPT                     |   1997 | 469857101.508784
 EGYPT                     |   1996 |  472680545.38865
 EGYPT                     |   1995 |  463167565.52232
 EGYPT                     |   1994 | 456525125.464536
 EGYPT                     |   1993 | 466334788.049156
 EGYPT                     |   1992 | 469056650.470089
 ETHIOPIA                  |   1998 | 264451322.770947
 ETHIOPIA                  |   1997 |  453592087.25068
 ETHIOPIA                  |   1996 | 450003563.917006
 ETHIOPIA                  |   1995 |   454272469.4092
 ETHIOPIA                  |   1994 | 455314926.785175
 ETHIOPIA                  |   1993 | 458607414.894797
 ETHIOPIA                  |   1992 | 458261903.912157
 FRANCE                    |   1998 | 273804106.541697
 FRANCE                    |   1997 | 464281429.599534
 FRANCE                    |   1996 | 465483311.723778
 FRANCE                    |   1995 | 458351696.088512
 FRANCE                    |   1994 | 459893628.318767
 FRANCE                    |   1993 | 461789190.456555
 FRANCE                    |   1992 | 461167565.942289
 GERMANY                   |   1998 |  279247182.03647
 GERMANY                   |   1997 | 477167262.074441
 GERMANY                   |   1996 | 475628216.472062
 GERMANY                   |   1995 | 464446443.032256
 GERMANY                   |   1994 | 481529530.804593
 GERMANY                   |   1993 | 474043725.117045
 GERMANY                   |   1992 | 479510777.849035
 INDIA                     |   1998 | 276381330.916587
 INDIA                     |   1997 | 465105019.801355
 INDIA                     |   1996 | 471108600.335206
 INDIA                     |   1995 | 475685104.689497
 INDIA                     |   1994 | 468656352.229599
 INDIA                     |   1993 | 468494003.622769
 INDIA                     |   1992 | 476988667.277424
 INDONESIA                 |   1998 | 275813008.688723
 INDONESIA                 |   1997 |  461061052.03862
 INDONESIA                 |   1996 | 465804056.400354
 INDONESIA                 |   1995 | 467966581.811682
 INDONESIA                 |   1994 | 463807083.525112
 INDONESIA                 |   1993 | 467724749.000379
 INDONESIA                 |   1992 | 458308666.109722
 IRAN                      |   1998 | 272034772.093621
 IRAN                      |   1997 |   464780007.4596
 IRAN                      |   1996 | 470318006.218921
 IRAN                      |   1995 |  470150035.80395
 IRAN                      |   1994 | 466893714.123777
 IRAN                      |   1993 | 463187080.746318
 IRAN                      |   1992 | 464723514.397417
 IRAQ                      |   1998 | 275445472.255995
 IRAQ                      |   1997 | 471447047.709873
 IRAQ                      |   1996 | 477173857.954665
 IRAQ                      |   1995 | 471333195.545826
 IRAQ                      |   1994 | 474117146.192955
 IRAQ                      |   1993 | 475538681.759213
 IRAQ                      |   1992 | 474168090.829343
 JAPAN                     |   1998 | 273715727.322463
 JAPAN                     |   1997 | 464097426.162863
 JAPAN                     |   1996 | 463295041.331391
 JAPAN                     |   1995 |   457311472.3198
 JAPAN                     |   1994 | 451682622.225658
 JAPAN                     |   1993 | 462362861.464236
 JAPAN                     |   1992 | 462952309.411456
 JORDAN                    |   1998 | 272827523.504296
 JORDAN                    |   1997 | 468378900.359532
 JORDAN                    |   1996 | 459855576.507598
 JORDAN                    |   1995 | 453492617.959177
 JORDAN                    |   1994 | 462195741.182291
 JORDAN                    |   1993 | 464936776.586016
 JORDAN                    |   1992 | 463082367.564771
 KENYA                     |   1998 | 271096126.430009
 KENYA                     |   1997 | 467385964.950823
 KENYA                     |   1996 | 471961846.068397
 KENYA                     |   1995 | 470851397.228425
 KENYA                     |   1994 | 473136359.474354
 KENYA                     |   1993 | 469084352.648121
 KENYA                     |   1992 | 474307042.192265
 MOROCCO                   |   1998 | 266242639.288014
 MOROCCO                   |   1997 | 468721649.856021
 MOROCCO                   |   1996 | 466504633.133092
 MOROCCO                   |   1995 | 462400514.397515
 MOROCCO                   |   1994 | 459915861.356732
 MOROCCO                   |   1993 | 465957594.652483
 MOROCCO                   |   1992 | 464519572.818699
 MOZAMBIQUE                |   1998 | 271018925.273321
 MOZAMBIQUE                |   1997 | 454161549.307581
 MOZAMBIQUE                |   1996 | 454524142.211282
 MOZAMBIQUE                |   1995 | 458461571.148494
 MOZAMBIQUE                |   1994 | 461946085.231335
 MOZAMBIQUE                |   1993 | 459123652.626789
 MOZAMBIQUE                |   1992 |  461245158.69237
 PERU                      |   1998 | 268920153.031433
 PERU                      |   1997 | 469618718.677394
 PERU                      |   1996 | 471671918.174769
 PERU                      |   1995 | 467170499.653914
 PERU                      |   1994 | 459701492.538359
 PERU                      |   1993 | 470131027.801532
 PERU                      |   1992 | 461376178.346034
 ROMANIA                   |   1998 | 275631305.694053
 ROMANIA                   |   1997 |  464540577.74134
 ROMANIA                   |   1996 | 471658040.407907
 ROMANIA                   |   1995 | 467250391.690181
 ROMANIA                   |   1994 | 465709222.204119
 ROMANIA                   |   1993 | 473440454.596682
 ROMANIA                   |   1992 |  471507460.02338
 RUSSIA                    |   1998 | 270685383.737077
 RUSSIA                    |   1997 | 464953208.432543
 RUSSIA                    |   1996 | 475263908.641192
 RUSSIA                    |   1995 | 466893877.782051
 RUSSIA                    |   1994 | 462913109.775025
 RUSSIA                    |   1993 | 469379817.171116
 RUSSIA                    |   1992 | 464342107.320176
 SAUDI ARABIA              |   1998 | 278681565.987731
 SAUDI ARABIA              |   1997 | 475551575.275104
 SAUDI ARABIA              |   1996 | 463377876.385252
 SAUDI ARABIA              |   1995 | 468953568.730247
 SAUDI ARABIA              |   1994 | 471838051.665713
 SAUDI ARABIA              |   1993 | 460973287.366949
 SAUDI ARABIA              |   1992 | 467846930.948995
 UNITED KINGDOM            |   1998 | 263505436.013034
 UNITED KINGDOM            |   1997 | 449846171.722841
 UNITED KINGDOM            |   1996 | 453473681.702363
 UNITED KINGDOM            |   1995 |  458744548.41009
 UNITED KINGDOM            |   1994 | 465305127.873729
 UNITED KINGDOM            |   1993 | 452178311.213405
 UNITED KINGDOM            |   1992 | 453587923.921962
 UNITED STATES             |   1998 | 266402484.232425
 UNITED STATES             |   1997 | 466767881.589101
 UNITED STATES             |   1996 | 462668048.344417
 UNITED STATES             |   1995 | 462903102.842498
 UNITED STATES             |   1994 | 463807225.330829
 UNITED STATES             |   1993 | 460654642.952809
 UNITED STATES             |   1992 | 460963168.604946
 VIETNAM                   |   1998 |  272779560.96291
 VIETNAM                   |   1997 | 462794263.103496
 VIETNAM                   |   1996 | 466206146.050879
 VIETNAM                   |   1995 | 467946292.639039
 VIETNAM                   |   1994 | 475643629.583283
 VIETNAM                   |   1993 | 466255379.836943
 VIETNAM                   |   1992 | 461959148.527608
(175 rows)

COMMIT;
COMMIT
