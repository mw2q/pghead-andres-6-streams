BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%wheat%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 267292292.686777
 ALGERIA                   |   1997 | 455565154.275841
 ALGERIA                   |   1996 | 452927571.928084
 ALGERIA                   |   1995 | 459803439.408723
 ALGERIA                   |   1994 | 451246083.818237
 ALGERIA                   |   1993 |  456881307.65683
 ALGERIA                   |   1992 | 457925646.886635
 ARGENTINA                 |   1998 | 272675706.259621
 ARGENTINA                 |   1997 | 473900760.748748
 ARGENTINA                 |   1996 | 470284369.137099
 ARGENTINA                 |   1995 | 467223918.161769
 ARGENTINA                 |   1994 | 475466265.866138
 ARGENTINA                 |   1993 | 467593817.784361
 ARGENTINA                 |   1992 | 475479925.893582
 BRAZIL                    |   1998 | 275005965.072343
 BRAZIL                    |   1997 | 467511432.190122
 BRAZIL                    |   1996 | 467222874.706241
 BRAZIL                    |   1995 | 466315222.520467
 BRAZIL                    |   1994 | 469148468.609967
 BRAZIL                    |   1993 | 464858530.180447
 BRAZIL                    |   1992 | 477854207.489565
 CANADA                    |   1998 | 281118877.731565
 CANADA                    |   1997 | 481396325.466704
 CANADA                    |   1996 | 478304977.187716
 CANADA                    |   1995 | 476186380.548943
 CANADA                    |   1994 | 485622865.894863
 CANADA                    |   1993 | 479994009.863781
 CANADA                    |   1992 | 477456290.005776
 CHINA                     |   1998 | 274250932.506461
 CHINA                     |   1997 | 468652850.778266
 CHINA                     |   1996 | 472223066.353644
 CHINA                     |   1995 | 456650622.331681
 CHINA                     |   1994 | 468945434.621345
 CHINA                     |   1993 | 475274549.413048
 CHINA                     |   1992 | 468923870.997815
 EGYPT                     |   1998 | 276728449.484603
 EGYPT                     |   1997 | 462233493.689608
 EGYPT                     |   1996 | 466535507.129994
 EGYPT                     |   1995 | 462925918.881031
 EGYPT                     |   1994 |  464399608.62431
 EGYPT                     |   1993 | 459881151.866149
 EGYPT                     |   1992 | 462673349.305804
 ETHIOPIA                  |   1998 | 263580584.593165
 ETHIOPIA                  |   1997 |  450917823.85881
 ETHIOPIA                  |   1996 | 453139191.990056
 ETHIOPIA                  |   1995 | 454103692.436232
 ETHIOPIA                  |   1994 | 459601472.991854
 ETHIOPIA                  |   1993 |  454210794.60982
 ETHIOPIA                  |   1992 | 453125334.149609
 FRANCE                    |   1998 | 269229446.621344
 FRANCE                    |   1997 | 454037538.546177
 FRANCE                    |   1996 | 460037793.146971
 FRANCE                    |   1995 | 466397774.861233
 FRANCE                    |   1994 |  453857209.72186
 FRANCE                    |   1993 | 460012423.926483
 FRANCE                    |   1992 | 459384727.878436
 GERMANY                   |   1998 | 278054059.542721
 GERMANY                   |   1997 | 473839509.553653
 GERMANY                   |   1996 | 472689547.048945
 GERMANY                   |   1995 | 468988162.564063
 GERMANY                   |   1994 |  471796914.20376
 GERMANY                   |   1993 | 473223445.562801
 GERMANY                   |   1992 | 467452939.631352
 INDIA                     |   1998 | 271035143.508114
 INDIA                     |   1997 | 468809480.009623
 INDIA                     |   1996 | 466510889.265952
 INDIA                     |   1995 | 465069024.492959
 INDIA                     |   1994 |  469897824.38588
 INDIA                     |   1993 | 464429165.517373
 INDIA                     |   1992 | 470944800.356019
 INDONESIA                 |   1998 | 268484512.983968
 INDONESIA                 |   1997 | 463298798.650907
 INDONESIA                 |   1996 | 458513899.747343
 INDONESIA                 |   1995 | 458088698.643128
 INDONESIA                 |   1994 | 463369278.783651
 INDONESIA                 |   1993 | 458369516.053819
 INDONESIA                 |   1992 | 459605607.766252
 IRAN                      |   1998 | 268296180.136897
 IRAN                      |   1997 | 446802641.149918
 IRAN                      |   1996 | 460529511.805397
 IRAN                      |   1995 | 454824769.880012
 IRAN                      |   1994 | 459831303.182013
 IRAN                      |   1993 | 453911424.894929
 IRAN                      |   1992 |  455553596.06642
 IRAQ                      |   1998 |  277189288.91741
 IRAQ                      |   1997 | 470577415.779408
 IRAQ                      |   1996 |  473310084.41463
 IRAQ                      |   1995 | 472150545.647943
 IRAQ                      |   1994 |  469124185.43723
 IRAQ                      |   1993 | 469350391.027693
 IRAQ                      |   1992 | 465029115.011469
 JAPAN                     |   1998 | 271264136.155471
 JAPAN                     |   1997 | 466376695.177759
 JAPAN                     |   1996 | 460715092.589402
 JAPAN                     |   1995 | 464268468.025963
 JAPAN                     |   1994 | 469598374.362079
 JAPAN                     |   1993 | 473952514.719466
 JAPAN                     |   1992 | 465600946.165432
 JORDAN                    |   1998 | 271265054.440111
 JORDAN                    |   1997 | 465391040.027142
 JORDAN                    |   1996 |  456671508.25963
 JORDAN                    |   1995 | 459422116.327777
 JORDAN                    |   1994 | 459571649.749343
 JORDAN                    |   1993 | 461772183.744633
 JORDAN                    |   1992 | 463527253.196599
 KENYA                     |   1998 | 272675524.478421
 KENYA                     |   1997 | 460925331.250484
 KENYA                     |   1996 | 467764593.686052
 KENYA                     |   1995 | 459019597.676936
 KENYA                     |   1994 | 460317787.331771
 KENYA                     |   1993 | 465749796.773626
 KENYA                     |   1992 | 464030532.283915
 MOROCCO                   |   1998 | 272894338.427612
 MOROCCO                   |   1997 | 466835806.994769
 MOROCCO                   |   1996 |   472502954.8772
 MOROCCO                   |   1995 | 469969178.107931
 MOROCCO                   |   1994 | 463753499.277656
 MOROCCO                   |   1993 | 468851428.790957
 MOROCCO                   |   1992 | 471106816.995571
 MOZAMBIQUE                |   1998 | 273564184.394182
 MOZAMBIQUE                |   1997 | 455492241.435927
 MOZAMBIQUE                |   1996 | 464412487.631293
 MOZAMBIQUE                |   1995 | 460102613.904964
 MOZAMBIQUE                |   1994 | 458751511.102124
 MOZAMBIQUE                |   1993 | 454041131.999951
 MOZAMBIQUE                |   1992 | 461294349.917064
 PERU                      |   1998 | 268459007.000603
 PERU                      |   1997 | 474371798.336688
 PERU                      |   1996 | 470142326.819703
 PERU                      |   1995 | 458061393.906644
 PERU                      |   1994 | 467551100.966696
 PERU                      |   1993 | 466964553.694517
 PERU                      |   1992 | 476490529.002166
 ROMANIA                   |   1998 | 271957205.978738
 ROMANIA                   |   1997 | 459103705.268167
 ROMANIA                   |   1996 | 466244676.724221
 ROMANIA                   |   1995 | 462162861.983128
 ROMANIA                   |   1994 | 456959626.585341
 ROMANIA                   |   1993 | 457789686.634464
 ROMANIA                   |   1992 |  460446312.21768
 RUSSIA                    |   1998 | 280717227.637339
 RUSSIA                    |   1997 | 467964282.151199
 RUSSIA                    |   1996 |  480326609.35193
 RUSSIA                    |   1995 | 471624388.440303
 RUSSIA                    |   1994 | 471578953.237535
 RUSSIA                    |   1993 | 467095368.105438
 RUSSIA                    |   1992 | 464689169.184663
 SAUDI ARABIA              |   1998 |  279287258.26312
 SAUDI ARABIA              |   1997 | 464989247.132428
 SAUDI ARABIA              |   1996 | 477273240.673385
 SAUDI ARABIA              |   1995 |  465611103.52053
 SAUDI ARABIA              |   1994 | 466247995.327847
 SAUDI ARABIA              |   1993 | 468771691.737164
 SAUDI ARABIA              |   1992 | 472982204.788193
 UNITED KINGDOM            |   1998 | 271233809.485784
 UNITED KINGDOM            |   1997 | 455989555.127158
 UNITED KINGDOM            |   1996 |  454362148.96075
 UNITED KINGDOM            |   1995 |  454466146.07826
 UNITED KINGDOM            |   1994 | 460369917.076795
 UNITED KINGDOM            |   1993 | 457980991.481376
 UNITED KINGDOM            |   1992 | 450805378.890867
 UNITED STATES             |   1998 | 274908908.816264
 UNITED STATES             |   1997 | 469194880.220031
 UNITED STATES             |   1996 | 462726143.927703
 UNITED STATES             |   1995 | 465064262.906596
 UNITED STATES             |   1994 | 472636685.516373
 UNITED STATES             |   1993 | 463273428.236676
 UNITED STATES             |   1992 | 467521213.230182
 VIETNAM                   |   1998 | 271081319.186892
 VIETNAM                   |   1997 | 458002940.594545
 VIETNAM                   |   1996 | 465702424.969496
 VIETNAM                   |   1995 | 462803656.972616
 VIETNAM                   |   1994 | 468532692.758822
 VIETNAM                   |   1993 | 466692710.039933
 VIETNAM                   |   1992 | 463260714.137436
(175 rows)

COMMIT;
COMMIT
