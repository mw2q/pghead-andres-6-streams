BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%forest%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 263901527.188766
 ALGERIA                   |   1997 | 461540241.059852
 ALGERIA                   |   1996 | 454914595.365708
 ALGERIA                   |   1995 |  453601092.91526
 ALGERIA                   |   1994 |  456897325.55838
 ALGERIA                   |   1993 | 460136979.435319
 ALGERIA                   |   1992 | 457642568.946487
 ARGENTINA                 |   1998 | 274663472.967603
 ARGENTINA                 |   1997 | 464570597.184865
 ARGENTINA                 |   1996 | 470746741.360961
 ARGENTINA                 |   1995 | 476761469.576596
 ARGENTINA                 |   1994 | 466095834.963932
 ARGENTINA                 |   1993 | 467272544.444191
 ARGENTINA                 |   1992 | 472488366.247825
 BRAZIL                    |   1998 | 270233867.584227
 BRAZIL                    |   1997 | 470145489.574271
 BRAZIL                    |   1996 | 469114508.307772
 BRAZIL                    |   1995 | 478346767.976735
 BRAZIL                    |   1994 |  469937985.52967
 BRAZIL                    |   1993 |  467060073.48415
 BRAZIL                    |   1992 | 465055400.960464
 CANADA                    |   1998 | 269076338.485135
 CANADA                    |   1997 | 470246960.823593
 CANADA                    |   1996 | 473152676.771956
 CANADA                    |   1995 | 468859877.170267
 CANADA                    |   1994 | 475239025.487826
 CANADA                    |   1993 | 463049434.694352
 CANADA                    |   1992 | 473682813.510119
 CHINA                     |   1998 | 275126569.063436
 CHINA                     |   1997 | 475181535.618478
 CHINA                     |   1996 | 470116649.442772
 CHINA                     |   1995 | 464818856.623948
 CHINA                     |   1994 | 476042640.778336
 CHINA                     |   1993 | 479521538.277705
 CHINA                     |   1992 | 473768558.851403
 EGYPT                     |   1998 | 276052802.937752
 EGYPT                     |   1997 | 460541078.448528
 EGYPT                     |   1996 | 463202874.203462
 EGYPT                     |   1995 | 462299600.909128
 EGYPT                     |   1994 | 463993675.560867
 EGYPT                     |   1993 | 460304471.533685
 EGYPT                     |   1992 | 463322490.624419
 ETHIOPIA                  |   1998 | 267625001.314728
 ETHIOPIA                  |   1997 |  463782339.69294
 ETHIOPIA                  |   1996 | 454826840.665328
 ETHIOPIA                  |   1995 | 460288579.408577
 ETHIOPIA                  |   1994 | 460775137.933851
 ETHIOPIA                  |   1993 | 456531092.313179
 ETHIOPIA                  |   1992 | 464013456.802962
 FRANCE                    |   1998 | 272867117.534613
 FRANCE                    |   1997 | 463395703.220787
 FRANCE                    |   1996 | 461876930.941929
 FRANCE                    |   1995 | 463570267.316858
 FRANCE                    |   1994 | 461987355.118864
 FRANCE                    |   1993 | 453737655.701511
 FRANCE                    |   1992 | 463243638.877991
 GERMANY                   |   1998 | 278588003.143392
 GERMANY                   |   1997 | 484839378.993058
 GERMANY                   |   1996 | 476816981.268831
 GERMANY                   |   1995 | 473259340.355782
 GERMANY                   |   1994 | 468418069.103539
 GERMANY                   |   1993 | 470208224.902323
 GERMANY                   |   1992 | 475087401.329025
 INDIA                     |   1998 | 273741520.905226
 INDIA                     |   1997 | 469678014.035051
 INDIA                     |   1996 | 480676252.115978
 INDIA                     |   1995 | 480474606.827076
 INDIA                     |   1994 | 474622652.876064
 INDIA                     |   1993 | 476545136.210983
 INDIA                     |   1992 |  480433944.63227
 INDONESIA                 |   1998 | 278474083.637647
 INDONESIA                 |   1997 | 470392099.876342
 INDONESIA                 |   1996 | 477379238.400264
 INDONESIA                 |   1995 | 471283345.036041
 INDONESIA                 |   1994 |  477218090.11059
 INDONESIA                 |   1993 | 471033760.529213
 INDONESIA                 |   1992 |  472689966.94425
 IRAN                      |   1998 | 271635485.230346
 IRAN                      |   1997 | 471797065.247334
 IRAN                      |   1996 |   463416216.3903
 IRAN                      |   1995 | 464266639.375106
 IRAN                      |   1994 | 471458010.533459
 IRAN                      |   1993 | 467476237.031996
 IRAN                      |   1992 |  472901878.40176
 IRAQ                      |   1998 | 272269948.254665
 IRAQ                      |   1997 | 460427792.879504
 IRAQ                      |   1996 | 469393678.865593
 IRAQ                      |   1995 | 458636546.507598
 IRAQ                      |   1994 | 464569007.296657
 IRAQ                      |   1993 | 464352539.108491
 IRAQ                      |   1992 | 463883743.904066
 JAPAN                     |   1998 | 273999119.289959
 JAPAN                     |   1997 | 469388184.478702
 JAPAN                     |   1996 | 458980653.546533
 JAPAN                     |   1995 |  458791860.84691
 JAPAN                     |   1994 |  467940118.23714
 JAPAN                     |   1993 | 467368155.144066
 JAPAN                     |   1992 | 464362107.838111
 JORDAN                    |   1998 | 268732906.792726
 JORDAN                    |   1997 | 454202198.702417
 JORDAN                    |   1996 | 463030958.199173
 JORDAN                    |   1995 | 462929479.802478
 JORDAN                    |   1994 | 466679022.093418
 JORDAN                    |   1993 | 462583682.581641
 JORDAN                    |   1992 | 462339058.502438
 KENYA                     |   1998 | 271750837.646632
 KENYA                     |   1997 | 476451293.863596
 KENYA                     |   1996 | 471125918.284399
 KENYA                     |   1995 | 476904228.342975
 KENYA                     |   1994 | 470741515.573564
 KENYA                     |   1993 | 476320105.018452
 KENYA                     |   1992 |  472491197.50629
 MOROCCO                   |   1998 | 271549371.460679
 MOROCCO                   |   1997 | 465830348.651938
 MOROCCO                   |   1996 |  454080313.46309
 MOROCCO                   |   1995 | 465741476.498754
 MOROCCO                   |   1994 |  463395815.52698
 MOROCCO                   |   1993 | 470161475.064693
 MOROCCO                   |   1992 | 469254928.330945
 MOZAMBIQUE                |   1998 | 260591884.585569
 MOZAMBIQUE                |   1997 | 447406344.292813
 MOZAMBIQUE                |   1996 | 455372856.774747
 MOZAMBIQUE                |   1995 | 458919982.201485
 MOZAMBIQUE                |   1994 |  456346845.74026
 MOZAMBIQUE                |   1993 | 454089374.294283
 MOZAMBIQUE                |   1992 | 460603133.617703
 PERU                      |   1998 | 273573455.608595
 PERU                      |   1997 | 465097307.538956
 PERU                      |   1996 | 470273496.878523
 PERU                      |   1995 | 465851126.628845
 PERU                      |   1994 | 462127724.068853
 PERU                      |   1993 | 464595889.347157
 PERU                      |   1992 | 462883231.752391
 ROMANIA                   |   1998 | 273733176.353511
 ROMANIA                   |   1997 | 465465654.777767
 ROMANIA                   |   1996 | 466983348.856277
 ROMANIA                   |   1995 | 468436434.019012
 ROMANIA                   |   1994 |   475205031.5849
 ROMANIA                   |   1993 |  464083959.70816
 ROMANIA                   |   1992 | 473962306.608642
 RUSSIA                    |   1998 | 275294135.974589
 RUSSIA                    |   1997 | 463957490.930891
 RUSSIA                    |   1996 |  470877605.30725
 RUSSIA                    |   1995 | 462602914.012504
 RUSSIA                    |   1994 | 463081935.188313
 RUSSIA                    |   1993 | 466797961.206048
 RUSSIA                    |   1992 | 460060643.157586
 SAUDI ARABIA              |   1998 | 270652673.350031
 SAUDI ARABIA              |   1997 | 465869410.966161
 SAUDI ARABIA              |   1996 | 473323729.167637
 SAUDI ARABIA              |   1995 | 471052615.673795
 SAUDI ARABIA              |   1994 | 470762801.681655
 SAUDI ARABIA              |   1993 | 462245405.566852
 SAUDI ARABIA              |   1992 | 464002312.793471
 UNITED KINGDOM            |   1998 | 266387122.589749
 UNITED KINGDOM            |   1997 | 462238367.344441
 UNITED KINGDOM            |   1996 | 459323995.891887
 UNITED KINGDOM            |   1995 | 457824142.889731
 UNITED KINGDOM            |   1994 | 459878740.469914
 UNITED KINGDOM            |   1993 |  456580000.25592
 UNITED KINGDOM            |   1992 | 460942623.769679
 UNITED STATES             |   1998 | 277567107.965276
 UNITED STATES             |   1997 | 474798370.104732
 UNITED STATES             |   1996 | 469557602.841516
 UNITED STATES             |   1995 |  467578434.51728
 UNITED STATES             |   1994 | 477608439.675046
 UNITED STATES             |   1993 | 465039431.290522
 UNITED STATES             |   1992 | 473071830.494369
 VIETNAM                   |   1998 | 272074945.654431
 VIETNAM                   |   1997 | 458028885.953341
 VIETNAM                   |   1996 | 461597030.459618
 VIETNAM                   |   1995 | 454062270.656582
 VIETNAM                   |   1994 | 454853103.876564
 VIETNAM                   |   1993 |  459350594.34543
 VIETNAM                   |   1992 | 455787495.424943
(175 rows)

COMMIT;
COMMIT
